FROM node:18-alpine

ENV DATABASE=minitmoneydb
ENV DB_USERNAME=treasure
ENV DB_PASSWORD=@pass
ENV DB_HOST=localhost
ENV DB_PORT=3306
ENV BCRYPT_SALT_NUM=12
ENV APPPORT=5500
ENV CRYPT_CODE=@MINITMONEY@SVC
ENV REFRESHTOKENSECRET=2245bd9e9b62e7de622289728ad87626d830b1fbbc1f8892e3e8e4629c032b77
ENV TOKENSECRET=6145bd9e9b62e7de622289728ad87626d830b1fbbc1f6492e3e8e4629c032b00
ENV DATABASE_URL="mysql://treasure:@pass@localhost:3306/minitmoneydb"

WORKDIR /app

COPY package*.json . 

COPY . .

RUN npm install

RUN npx prisma generate

RUN npm run build

EXPOSE 8086 

CMD [ "npm", "run", "start"]